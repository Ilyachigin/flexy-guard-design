<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Flexy Guard Rule Builer | Dashboard</title>
  <!-- Tell the browser to be responsive to screen width -->
  <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
  <!-- Bootstrap 3.3.7 -->
  <link rel="stylesheet" href="{{ url_for('static', filename='default/bower_components/dist/css/bootstrap.min.css') }}">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="{{ url_for('static', filename='adminlte/bower_components/font-awesome/css/font-awesome.min.css') }}">
  <!-- Ionicons -->
  <link rel="stylesheet" href="{{ url_for('static', filename='adminlte/bower_components/Ionicons/css/ionicons.min.css') }}">
  <!-- jvectormap -->
  <link rel="stylesheet" href="{{ url_for('static', filename='adminlte/bower_components/jvectormap/jquery-jvectormap.css') }}">
  <!-- Theme style -->
  <!-- link rel="stylesheet" href="{{ url_for('static', filename='adminlte/css/AdminLTE.min.css') }}" -->
  <!-- AdminLTE Skins. Choose a skin from the css/skins
       folder instead of downloading all of them to reduce the load. -->
  <link rel="stylesheet" href="{{ url_for('static', filename='adminlte/css/skins/_all-skins.min.css') }}">

  <link href="{{ url_for('static', filename='jsoneditor/dist/jsoneditor.min.css') }}" rel="stylesheet" type="text/css">

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->

  <!-- Google Font -->
  <link rel="stylesheet"
        href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic">

  <link href="https://fonts.googleapis.com/css2?family=Barlow:wght@400;500;600&display=swap" rel="stylesheet">
  <link 
    rel="stylesheet"
    href=" {{ url_for('static', filename='styles/__index.css') }}"
  />

</head>
<body class="hold-transition skin-blue sidebar-mini">

<div class="container" style="height: auto; min-height: 100%;">

  <aside class="main-sidebar">
    <section class="sidebar">
      <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <h2 class="navbar-brand">Flexy Guard</h2>
        <div class="collapse navbar-collapse">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="/list">Rules</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/lists">BIN/IP: Countries list</a>
            </li></ul>

          <form action="{{ url_for('search') }}" method="post" class="d-flex">
            <div class="input-group">
              <input type="text" name="text" class="form-control" placeholder="Search...">
              <span class="input-group-btn">
                    <button type="submit" name="search" id="search-btn" class="btn btn-flat">
                      <i class="fa fa-search"></i>
                    </button>
                  </span>
            </div>
          </form>
        </div>

      </nav>

    </section>
  </aside>

  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
      <h1> Flexy Guard Rules </h1>
    </section>

    <!-- Main content -->
    <section class="content">
      <div class="row">
        <div class="box">


          <div class="mb-3">
            <h4>Create rule by preset</h4>
            <div class="row">
              <div class="col-sm-5">
                <select name="preset" class="form-select">
                  <option value="" selected>Approved-Turnover-per-Gateway</option>
                </select>
              </div>
              <div class="col-sm-7">
                <button class="btn btn-secondary">Create preset</button>
              </div>
            </div>

          <!-- /.box-header -->
          <div class="box-body">
            <h4>Rules</h4>
            <a href="{{ url_for('new_rule') }}" class="btn btn-success" style="margin: 10px;">Add new rule</a>
            <table class="table table-bordered table-striped table-hover">
              <col width="40%">
              <col width="25%">
              <col width="15%">
              <col width="20%">
              <thead>
              <tr>
                <th>Name</th>
                <th>Operation</th>
                <th>CreatedAt</th>
                <th>Actions</th>
              </tr>
              </thead>
              <tbody>
              <tr>
                <td>Approved-Turnover-per-Gateway</td>
                <td>PayinReqyest</td>
                <td>July 28, 2021</td>
                <td>
                  <a href="" class="btn btn-primary">Edit rule</a>
                  <a class="btn btn-danger js-item-delete">Delete rule</a>
                </td>
              </tr>
              {% for item in rlist %}
              <tr>
                <td> {{item['Comment']}} </td>
                <td> {{item['Operation']}} </td>
                <td> {{item['CreatedAt']}} </td>
                <td>
                  <a href="{{ url_for('edit_rule', id = item['Hash']) }}" class="btn btn-primary">Edit rule</a>
                  <a href="{{ url_for('edit_rule', id = item['Hash']) }}" class="btn btn-danger">Delete rule</a>
                </td>
              </tr>
              {% endfor %}
              </tbody>
            </table>
          </div>
          <!-- /.box-body -->
        </div>
      </div>

      <div class="row">
      </div>
    </section>
    <!-- /.content -->

  </div>
  <!-- /.content-wrapper -->

  <!-- /.control-sidebar -->
  <!-- Add the sidebar's background. This div must be placed
       immediately after the control sidebar -->
  <div class="control-sidebar-bg"></div>

</div>
<!-- ./wrapper -->

<!-- jQuery 3 -->
<script src="{{ url_for('static', filename='adminlte/bower_components/jquery/dist/jquery.min.js') }}"></script>
<!-- Bootstrap 3.3.7 -->
<script src="{{ url_for('static', filename='adminlte/bower_components/bootstrap/dist/js/bootstrap.min.js') }}"></script>
<!-- FastClick -->
<script src="{{ url_for('static', filename='adminlte/bower_components/fastclick/lib/fastclick.js') }}"></script>
<!-- AdminLTE App -->
<script src="{{ url_for('static', filename='adminlte/js/adminlte.min.js') }}"></script>
<!-- Sparkline -->
<script src="{{ url_for('static', filename='adminlte/bower_components/jquery-sparkline/dist/jquery.sparkline.min.js') }}"></script>
<!-- jvectormap  -->
<script src="{{ url_for('static', filename='adminlte/plugins/jvectormap/jquery-jvectormap-1.2.2.min.js') }}"></script>
<script src="{{ url_for('static', filename='adminlte/plugins/jvectormap/jquery-jvectormap-world-mill-en.js') }}"></script>
<!-- SlimScroll -->
<script src="{{ url_for('static', filename='adminlte/bower_components/jquery-slimscroll/jquery.slimscroll.min.js') }}"></script>
<!-- ChartJS -->
<script src="{{ url_for('static', filename='adminlte/bower_components/chart.js/Chart.js') }}"></script>
<!-- AdminLTE dashboard demo (This is only for demo purposes) -->
<!--<script src="{{ url_for('static', filename='js/pages/dashboard2.js') }}"></script>-->
<!-- AdminLTE for demo purposes -->
<script src="{{ url_for('static', filename='adminlte/js/demo.js') }}"></script>

<script src="{{ url_for('static', filename='jsoneditor/dist/jsoneditor.min.js') }}"></script>

<script>
    // create the editor
    var container = document.getElementById("jsoneditor");
    var options = {
      mode: 'tree',
      modes: ['code', 'form', 'text', 'tree', 'view']
    };
    var editor = new JSONEditor(container, options);


    // set json
    {% if edit %}
    var json = JSON.parse('{{ edit['Rule'] | safe}}')
    {% else %}

    var json = {
          "header": {
                  "mid": "123",
                  "acq_id": "1234",
                  "currency": "USD"
            },
            "body": {
              "card": {
                "count": {
                  "1": [0,70],
                  "7": [0, 1500]
                },
                "amount": {
                  "sum": {
                    "1": [0, 300000],
                    "30": [0, 500000]
                  },
                  "value": [10, 10000]
                },
                "not_in": ["sadsadasdasdasdasdas", "asdasdasd"],
                "in": ["qwerty"]
              },
              "bin": {
                "not_in_country": ["US", "CA"]
              }
            }
        };
        
    {% endif %}

    editor.set(json);

    // get json

    function submit_json() {
      var json = JSON.stringify(editor.get());
      $('#rule_json').val(json)

      return true
    }

</script>

</body>
</html>
